<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerenciamento de Usuários Comum</title>

  <!-- Fonte Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Ícones Lucide -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Link CSS -->
  <link rel="stylesheet" href="/css/pag-adm.css">
  <link rel="stylesheet" href="/css/adm-lista-usuarios.css">

      
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-notify@0.5.5/dist/simple-notify.min.css" />
 <script src="https://cdn.jsdelivr.net/npm/simple-notify@0.5.5/dist/simple-notify.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


      <!-- LINK DO FAVICON -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
   
      <!-- LINK DA FONTE -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
        <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>

        

</head>
<body>

    <!--INICIO DO MENU TOP ADM -->

    <%- include('../partials/menu_top_adm.ejs'); %>

    <!--FIM DO MENU TOP ADM  -->


<!-- MENU LATERAL DO ADM -->

  <%- include('../partials/menu_lateral_adm.ejs'); %>

<!-- MENU LATERAL DO ADM -->


  <section class="topo_pagina_adm">
    <h1>Gerenciamento de Usuários</h1>
    <button class="novo-user_adm"><i data-lucide="user-plus"></i> Novo Usuário</button>
  </section>

  <section class="resumo">
    <section class="card">
      <section class="card-icon azul"><i data-lucide="users"></i></section class=>
      <section class="card-content">
        <p>Total de Usuários</p>
        <h2><%= usuarios.length %></h2> <!-- Total de usuários -->
      </section class=>
    </section >
    <section class="card">
      <section class="card-icon verde"><i data-lucide="user-check"></i></section class=>
      <section class="card-content">
        <p>Usuários Ativos</p>
        <h2><%= usuarios.filter(u => u.STATUS_USUARIO === 'ativo').length %></h2> <!-- Usuários Ativos -->
      </section class=>
    </section >
   <section class="card">
      <section class="card-icon amarelo"><i data-lucide="alert-triangle"></i></section class=>
      <section class="card-content">
        <p>Usuários Pendentes</p>
        <h2><%= usuarios.filter(u => u.STATUS_USUARIO === 'pendente').length %></h2>
      </section class=>
   </section >
    <section class="card">
      <section class="card-icon vermelho"><i data-lucide="user-x"></i></section class=>
      <section class="card-content">
        <p>Usuários Inativos</p>
        <h2><%= usuarios.filter(u => u.STATUS_USUARIO === 'inativo').length %></h2> <!-- Usuários Inativos -->
      </section class=>
    </section >
  </section>

  <section class="lista">
    <h2>Lista de Usuários</h2>
  
    <section class="lista-usuarios">

      <% usuarios.filter(u => u.TIPO_USUARIO === 'comum').forEach(usuario => { %>
        <section class="usuario">
  <section class="user-info">
    <img src="/<%= usuario.FOTO_PERFIL_PASTA_USUARIO || 'imagens/foto-perfil.png' %>" alt="<%= usuario.NOME_USUARIO %>" />
    <section >
      <%= usuario.NOME_USUARIO %><br><small><%= usuario.EMAIL_USUARIO %></small>
    </section >
  </section class=>
  <p class="status <%= usuario.STATUS_USUARIO %>">
    <%= usuario.STATUS_USUARIO.charAt(0).toUpperCase() + usuario.STATUS_USUARIO.slice(1) %>
  </p>

  <!-- Aqui vai o tipo do usuário -->
  <p class="data">
    <%= usuario.TIPO_USUARIO ? usuario.TIPO_USUARIO.charAt(0).toUpperCase() + usuario.TIPO_USUARIO.slice(1) : 'Não informado' %>
  </p>

  <!-- Aqui vai o user (login) -->
  <p class="user-nameadm">
    <%= usuario.USER_USUARIO %>
  </p>

 <section class="acoes">
  <button class="btn-acao editar"><i data-lucide="icon-fullscreen"></i></button>
  <% if (usuario.STATUS_USUARIO !== 'ativo') { %>
    <button class="btn-acao ativar" data-id="<%= usuario.ID_USUARIO %>">
      <i data-lucide="user-check"></i>
    </button>
  <% } %>
  <button class="btn-acao deletar" data-id="<%= usuario.ID_USUARIO %>"> <!--Desativar usuário-->
    <i data-lucide="icon-shield-off"></i>
  </button>
</section >

</section>

      <% }) %>

    </section >
  </section>

  <!-- MODAIS -->

  <!-- Modal de Inativar Usuário -->
  <section class="overlay" id="overlay" aria-hidden="true">
    <section class="modal" role="dialog" aria-modal="true">
      <!-- Cabeçalho -->
      <header class="modal-header">
        <h3>Inativar Usuário</h3>
        <button class="close-modal" aria-label="Fechar">&times;</button>
      </header>

      <!-- Corpo -->
      <section class="modal-body">
        <section class="alerta">
          <section class="alerta-icone">
            <i data-lucide="alert-triangle"></i>
          </section class=>
          <section >
            <p><strong>Tem certeza que deseja inativar este usuário?</strong></p>
            <p class="detalhe">
              O usuário não poderá mais acessar o sistema até ser reativado.
            </p>
          </section >
        </section >

        <h4>Consequências da inativação:</h4>
        <ul>
          <li>Perda imediata de acesso ao sistema</li>
          <li>Dados preservados para reativação</li>
          <li>Notificação automática por email</li>
        </ul>
      </section >

      <!-- Rodapé -->
      <footer class="modal-footer">
        <button class="btn-cancelar">Cancelar</button>
        <button class="btn-confirmar">
          <i data-lucide="user-x"></i> Confirmar Inativação
        </button>
      </footer>
    </section>
  </section>


        <!-- PAGINAÇÃO DO NEGOCIO -->

<% if (typeof paginador !== 'undefined' && paginador) { %>
    <section class="notificador">
        <ul>
            <% for (var i = 1; i <= paginador.total_paginas; i++) { %>
                <% if (paginador.pagina_atual == i) { %>
                    <li><a class="atual" href="?pagina=<%= i %>"><%= i %></a></li>
                <% } else { %>
                    <li><a href="?pagina=<%= i %>"><%= i %></a></li>
                <% } %>
            <% } %>
        </ul>
    </section>
<% } %>





  <script>
    lucide.createIcons();
  </script>


    <!-- LINK DO MENU LATERAL -->
      <script src="/js/menu-lateral-adm.js"></script>

    <!-- LINK DAS NOTIFICAÇÕES -->
      <script src="js/simple-notify.js"></script>



  <script src="/js/modal_inativar_usuario.js"></script>
</body>
</html>
