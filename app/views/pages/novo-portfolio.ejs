<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novo Portfólio</title>
    <link rel="stylesheet" href="css/novo-portfolio.css">
    
    <link rel="shortcut icon" href="imagens/favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"> 


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>


    
   


<!-- JS do Tagify -->
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
    

    

</head>

     
<body>

  
<% if (status_usuario === 'pendente') { %>
    <%- include('../partials/aviso-pendente') %>
    
<% } %>
  
    
    <%- include('../partials/menu-logado'); %>

<main>
    
            <h1 class="novaPublicacao">Novo portfólio</h1>
            <br>
            <p class="instrucao-tipo-btn">Preencha as informações abaixo para criar um novo portfólio:</p>
            <br>
            <form action="/criar-portfolio" method="post">
                <label for="titulo">Título:</label>
                <input type="text" id="titulo" name="titulo" required>

                <label for="descricao">Descrição:</label>
                <textarea id="descricao" name="descricao" required></textarea>

                <label for="descricao">Tags:</label> <br>
                <input   id="tagInput"  name='input-custom-dropdown' class='tags-look tagify--custom-dropdown caixa-texto' placeholder='Adicione tags à sua publicação...' value='Design Gráfico, Arte Digital'>
                          

                <input type="hidden" name="tags" id="tags-hidden">





                <label for="selecionar-publicacoes">Selecione algumas publicações para seu portfólio:</label>
              <section class="selecionar-publicacoes">
  <% if (publicacoes.length === 0) { %>
    <p>Você ainda não tem publicações.</p>
  <% } else { %>
    <% publicacoes.forEach(pub => { %>
      <div class="publicacao-item" data-id="<%= pub.ID_PUBLICACAO %>">
        <% if (pub.imagens && pub.imagens.length > 0) { %>
          <!-- Mostra só a primeira imagem -->
          <img 
            src="data:image/jpeg;base64,<%= pub.imagens[0].toString('base64') %>" 
            alt="Imagem da publicação <%= pub.ID_PUBLICACAO %>" />
        <% } else { %>
          <span style="display:flex;align-items:center;justify-content:center;color:#555;font-size:14px;">Sem imagem</span>
        <% } %>
      </div>
    <% }) %>
  <% } %>
</section>


<script>
const selectedIds = new Set();

document.querySelectorAll('.publicacao-item').forEach(div => {
  div.addEventListener('click', () => {
    const id = parseInt(div.dataset.id);
    if(selectedIds.has(id)) {
      selectedIds.delete(id);
      div.classList.remove('selected');
    } else {
      selectedIds.add(id);
      div.classList.add('selected');
    }
  });
});

document.querySelector('form').addEventListener('submit', e => {
  // associa publicações selecionadas
  const inputPublis = document.createElement('input');
  inputPublis.type = 'hidden';
  inputPublis.name = 'publicacoesSelecionadas';
  inputPublis.value = Array.from(selectedIds).join(',');
  e.target.appendChild(inputPublis);

  // associa tags como JSON
  const tagsHidden = document.getElementById('tags-hidden');
  tagsHidden.value = JSON.stringify(tagify.value.map(t => t.value));
});
</script>

                <button type="submit">Criar Portfólio</button>

                
            </form>

        </main>






<%- include('../partials/rodape'); %>

<script src="js/mobile-navbar.js"></script>

<script>
var input = document.querySelector('input[name="input-custom-dropdown"]');

var colors = [
  '#7490C9', 
  '#969ED0',  
  '#92C4E2', 
  '#B8D9BD', 
  '#9BB7CF', 
  '#C3E3DF',
  '#C2E5F0', 
  '#ADBCE2', 
 
];

function transformTag(tagData) {
  // escolhe uma cor da lista, aleatoriamente
  var color = colors[Math.floor(Math.random() * colors.length)];
  tagData.color = color;
  tagData.style = "--tag-bg:" + color;
}




var tagify = new Tagify(input, {
  whitelist: [
  // Design geral
  "Design Gráfico",
  "Design para Web",
  "Arte Digital",
  "UI/UX",
  "Design de Embalagens",
  "Design de Produto",
  "Ilustração Digital",
  "Tipografia",
  "Identidade Visual",
  "Branding",
  "Design Editorial",
  "Design de Interface",
  "Design Responsivo",
  
  // Estilos de arte
  "Arte Conceitual",
  "Arte Vetorial",
  "Arte Tradicional",
  "Pintura Digital",
  "Animação",
  "Motion Graphics",
  "Pixel Art",
  "Ilustração Infantil",
  "Quadrinhos",
  "Arte Abstrata",
  
  // Técnicas/ferramentas
  "Photoshop",
  "Illustrator",
  "Procreate",
  "CorelDRAW",
  "Sketch",
  "Figma",
  "Blender",
  "Cinema 4D",
  "After Effects",
  "InDesign",
  
  // Cores (para inspiração, tema, etc)
  "Cores Vibrantes",
  "Tons Pastel",
  "Monocromático",
  "Cores Frias",
  "Cores Quentes",
  "Paleta Neutra",
  "Contraste Alto",
  "Preto e Branco",
  
  // Outros
  "Tipografia Criativa",
  "Prototipagem",
  "Design de Aplicativos",
  "Design de Jogos",
  "Arte para Redes Sociais",
  "Ilustração Editorial",
  "Design Sustentável"
],

  maxTags: 10,
  dropdown: {
    maxItems: 20,
    classname: 'tags-look',
    enabled: 0,
    closeOnSelect: false
  },
  transformTag: transformTag
});





</script>










</body>
</html>


